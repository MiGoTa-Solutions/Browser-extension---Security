const r=async n=>{typeof chrome<"u"&&chrome.storage&&chrome.storage.local&&await chrome.storage.local.set({auth_token:n})},h=async()=>typeof chrome>"u"||!chrome.storage||!chrome.storage.local?null:(await chrome.storage.local.get("auth_token")).auth_token||null,l=async()=>{typeof chrome<"u"&&chrome.storage&&chrome.storage.local&&await chrome.storage.local.remove("auth_token")},m=async n=>{const e={},c={};return n.forEach(o=>{c[o.id]={name:o.name},o.domains.forEach(t=>{try{const s=new URL(t.startsWith("http")?t:`https://${t}`).hostname.replace(/^www\./,"");e[s]=o.id}catch{console.warn("Invalid domain in lock:",t)}})}),await chrome.storage.local.set({locked_domains:e,lock_metadata:c}),{domainCount:Object.keys(e).length}},i=async n=>{if(typeof chrome>"u"||!chrome.storage||!chrome.storage.local)return null;const{locked_domains:e,lock_metadata:c}=await chrome.storage.local.get(["locked_domains","lock_metadata"]);if(!e)return null;const o=n.replace(/^www\./,""),t=Object.keys(e).find(a=>o===a||o.endsWith("."+a));if(t){const a=e[t],s=c==null?void 0:c[a];return{id:a,name:(s==null?void 0:s.name)||"Locked Site"}}return null};export{i as a,l as c,h as g,r as s,m as u};
