const t="secureShield.auth",c="secureShield.locks";function a(){var r;return typeof chrome<"u"&&typeof((r=chrome.storage)==null?void 0:r.local)<"u"}async function s(r){a()&&await new Promise(e=>{try{chrome.storage.local.set({[t]:r},()=>e())}catch(o){console.warn("[SecureShield] Failed to persist auth data in chrome.storage",o),e()}})}async function i(){return a()?new Promise(r=>{try{chrome.storage.local.get([t],e=>{r((e==null?void 0:e[t])??null)})}catch(e){console.warn("[SecureShield] Failed to read auth data from chrome.storage",e),r(null)}}):null}async function m(){a()&&await new Promise(r=>{try{chrome.storage.local.remove([t,c],()=>r())}catch(e){console.warn("[SecureShield] Failed to remove auth data from chrome.storage",e),r()}})}async function u(r){if(!a())return;const e={};r.forEach(o=>{o.status==="locked"&&o.tabs.forEach(h=>{try{const n=new URL(h.url).hostname.replace(/^www\./,"");e[n]={lockId:o.id,name:o.name}}catch{}})}),await new Promise(o=>{chrome.storage.local.set({[c]:e},()=>o())})}async function l(){return a()?new Promise(r=>{chrome.storage.local.get([c],e=>{r((e==null?void 0:e[c])??{})})}):{}}export{l as a,m as c,i as r,u as s,s as w};
